--- 0. Defining Parameters for the 3-to-1 Factor Regime-Switching Model ---
Using device: cpu

--- 1. Generating Simulation Data from Regime-Switching Model ---
Simulation data generated.

--- 3/4. Getting Predictions from Expert Models (using true parameters) ---

--- 5. Defining the Prior for Weight Transition ---
Prior strength set to: 2.5

--- 6. Implementing and Training the BPS Model with Prior ---
Starting SVI training...
[iteration 0500] loss: 41023.1883
[iteration 1000] loss: 36198.2394
[iteration 1500] loss: 34889.1168
[iteration 2000] loss: 33614.9360
SVI training finished.

--- 7. Visualization of Results ---

Results plot saved to bps_weights_with_prior.png
